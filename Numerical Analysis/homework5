数值分析第五次上机练习实验报告
——数值积分与数值微分
力四 肖飞宇 2014011761
一、 问题的描述
给定函数φ（ x） , 利用不同数值积分方法计算在 1 到 3 之间的积分值，其中
函 数 表 达 式 为 φ(x) = 1
𝑥2 sin(2𝑥 𝜋) , 已 经 知 道 积 分 的 准 确 结 果 为 I = -
0.238762414637843……
（ 1） 方法一：讲所给区间分为四个子区间，使用五点的 Gauss-Legendre 求积公
式的复合求积公式计算。
（ 2） 方法二：使用 Romberg 求积方法计算， 其中取ε = 10−7 。
分别就两种方法互相之间和与精确值作比较。
二、 方法描述
作为高等数学最显著的特征或者说运算的微分和积分，几乎无处不在地
发挥着基础性的作用。当然，在我们学习高等微积分时，所涉及的函数大多
是初等函数，或者说一些有着很好的性质的函数，我们在计算其积分和微分
时，常常能够较为精确地求得其解析表达式，所以并没有感受到困难。
然而， 随着学习的深入， 所面临的问题的复杂度大大加深， 很多情况下，
就拿数值积分来说， 虽然理论上讲可以通过牛顿-莱布尼兹法则求得积分，
然而求原函数的过程往往是不可行的， 何况很多情况下， 求解的代价也是非
常大的。 另外， 在接触科研等实际问题后， 我也发现， 事实上， 在很多情况
下， 我们只能知道所积分函数在离散的点的函数值（这其实也促使我们思考
插值法等拟合逼近的思路和方法在数值积分中的可能应用），或者很多情况
下，我们只能得到该函数所满足的微分方程，当然绝大多数情况下没有解析
解，所以，数值求解积分便有了其必要性和重要作用。
现在所面临的问题就是在给定一个函数（其性质可能完全不清楚）在一
些离散点上的数值，希望能给出有一定数值精度和稳定性的积分算法。
所以， 首先会想到的是从积分的定义出发（黎曼积分）。“矩形分割，无
限逼近真实值”，这里，会自然的引发使用矩形法来求出一个近似值，虽然
显然这一方法的精度一般很差，但是却提供了一个很好的思路。
于是我们再次回答插值法， 在插值的意义下试图用多项式给出一个较为
精确的解， 于是就有了梯形公式和 Simpson 公式。
然而我们知道， 要想提高精度， 一个自然的想法是提高插值多项式的阶
数， 然而我们自然会想到 Runge 现象，所以有需要求助于分段低次插值。
于是便引出了等分区间， 然后做插值的方法。 特殊的是， 使用的插值多
项式为 Legengre 正交多项式，这可以带来数值稳定性和精度上的诸多好处，
于是便得到了五点的 Guass-Legendre 公式。
从另外一个思路上讲， 我们仿照迭代分析里面的 Aiken 加速方法，利用
每一步计算得到的值按照一定的法则做线性组合，或许可以得到更快的收敛
速度和精度。于是便有了 Richardson 外推方法和对应的 Romberg 求积方法。
三、 方案设计
分别编写了 GL.m 和 Romberge.m 两个子程序文件， 在 main.m 中调用子程序
进行数值积分的计算。
四、 计算结果和分析
（ 1） 使用 Guass-Legengre 复合求积公式求得的结果为
I=-0.238732340355842 相对误差为 e=0.000126
有效数位为 4 位
（ 2） 使用 Romberg 求积公式求得的结果为
I=-0.238732414678937 相对误差为 e=0.000125
有效数位为 10 位
关于两者的差别我们先从所积分函数的图像来做一个直观的考量：
被积函数函数图像
可以看出在所积分区间内， 函数的导函数变化很大， 所以使用细化的网格和
分段低次插值是有必要的。
而且实际上， 在 1 到 2.5 这个区段类应该设置更小的区间长度，而在变化比
较光滑的区间下应该是设置比较大的区间长度，这样精度应该会得到进一步
的提升。
所以， 对于改进性更大的第二种算法， 我尝试调节了误差界， 从 10^-7 到 10^-
16，得出计算结果分别如下表所示
Eps(误差界) I(数值积分数值)
10^-7 -0.238732414678937
10^-8 -0.238732414637975
10^-9 -0.238732414637975
10^-10 -0.238732414637975
10^-11 -0.238732414637844
10^-12 -0.238732414637844
10^-13 -0.238732414637844
10^-14 -0.238732414637844
10^15 -0.238732414637844
10^16 -0.238732414637843
可以看出，数值精度进一步增加，有效数位提升，到最后 10^-16 时，甚至和
给出的数值有着完全相同的 15 位有效数位。
五、 结论
学习本章内容其实是之前的很多诸如函数逼近等知识的一个进一步的自然
延伸与拓展， 而这一章的数值计算让我再次认识到数值计算的重要的作用和
在这一意义下所寻求好的相对普遍的积分计算方法的重要性，特别是在正交
多项式的应用和对于网格的细化处理等思想方面有了更加深刻的认识。
从计算机的处理的角度来看， 数值积分方法的意义是将微分和积分运算转换
成为了函数值的四则运算， 从而使得计算的难度和可行性大大提升， 也体现
了数值分析课程的强烈的计算机和数学结合的背景。
